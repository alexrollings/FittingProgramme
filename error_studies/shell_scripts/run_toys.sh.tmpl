#!/bin/bash
#PBS -l cput=01:59:59 
#PBS -N RUNTOYS_${DL}_${DH}_${BL}_${BH}_${nJob}

source /home/rollings/.zshrc.local
source_root

mkdir /data/lhcb/users/rollings/fitting_scripts/job_${DL}_${DH}_${BL}_${BH}_${nJob}
cd /data/lhcb/users/rollings/fitting_scripts/job_${DL}_${DH}_${BL}_${BH}_${nJob}

cp /home/rollings/Bu2Dst0h_2d/FittingProgramme/error_studies/CMakeMacroParseArguments.cmake /data/lhcb/users/rollings/fitting_scripts/job_${DL}_${DH}_${BL}_${BH}_${nJob}/CMakeMacroParseArguments.cmake 
cp /home/rollings/Bu2Dst0h_2d/FittingProgramme/error_studies/FindROOT.cmake /data/lhcb/users/rollings/fitting_scripts/job_${DL}_${DH}_${BL}_${BH}_${nJob}/FindROOT.cmake 
cp /home/rollings/Bu2Dst0h_2d/FittingProgramme/error_studies/CMakeLists.txt /data/lhcb/users/rollings/fitting_scripts/job_${DL}_${DH}_${BL}_${BH}_${nJob}/CMakeLists.txt 

mkdir src
cp /home/rollings/Bu2Dst0h_2d/FittingProgramme/error_studies/src/*.cpp src/
mkdir include
cp /home/rollings/Bu2Dst0h_2d/FittingProgramme/error_studies/include/*.h include/

mkdir build
cd build
cmake ../
make

./ToyD1D -bl=${BL} -bh=${BH} -dl=${DL} -dh=${DH} -nToys=${NTOYS} -outputDir=${PATH}
cd /data/lhcb/users/rollings/fitting_scripts/
rm -rf job_${DL}_${DH}_${BL}_${BH}_${nJob}
